#!/bin/bash

d="$(pwd)"

winname=$(printf "testing%d" $(tmux list-windows | wc -l))
cmd="teefifo $@ && tmux renamew -t ${winname} pass || tmux renamew -t ${winname} FAIL; echo -n 'press ENTER to close'; read x"
fullcmd=$(printf "tmux neww -d -c %s -n %s 'bash \"%s.sh\"'" "$d" "$winname" "$winname")

echo "$cmd" >"${winname}.sh"
echo "catting the file:"
cat "${winname}.sh"
echo "$fullcmd"
#echo "$fullcmd" "$cmd" | bash
#$fullcmd
#tmux neww -d -c "$d" -n "${winname}" "teefifo $@ && tmux renamew -t "${winname}" pass || tmux renamew -t "${winname}" FAIL; echo -n 'press ENTER to close'; read x"

# tmux neww -d -c "$d" -n "${winname}" "bash ${winname}.sh"
tmux neww -d -c "$d" -n "${winname}" "zsh -i ${winname}.sh"

#new-window (neww) [-adkP] [-c start-directory] [-F format] [-n window-name] [-t target-window] [command]
